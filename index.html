<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TITAN AI v5</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: #05080c;
  color: #00eaff;
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.container {
  width: 95%;
  max-width: 580px;
  border: 2px solid #00eaff;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 0 30px #00eaff55;
}

h1 {
  text-align: center;
  margin: 0;
}

.status {
  text-align: center;
  font-size: 13px;
  opacity: 0.85;
  margin-bottom: 8px;
}

.chat {
  height: 360px;
  overflow-y: auto;
  background: #020406;
  border: 1px solid #00eaff55;
  padding: 10px;
  margin-bottom: 10px;
}

.you { color: #ffffff; margin-bottom: 6px; }
.titan { color: #00eaff; margin-bottom: 6px; }

input, button {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: none;
}

input {
  background: #0a0f14;
  color: #00eaff;
}

button {
  margin-top: 6px;
  background: #00eaff;
  color: #000;
  font-weight: bold;
  cursor: pointer;
}
</style>
</head>

<body>
<div class="container">
  <h1>TITAN</h1>
  <div class="status" id="status"></div>

  <div class="chat" id="chat">
    <div class="titan">Titan offline. Say “hey titan” to activate.</div>
  </div>

  <input id="input" placeholder="Talk to Titan…" />
  <button onclick="handleInput()">Send</button>
</div>

<script>
/* =========================
   CORE SYSTEM
========================= */
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const status = document.getElementById("status");

let titan = JSON.parse(localStorage.getItem("titanState")) || {
  online: false,
  mode: "Calm",
  topic: null,
  memory: []
};

/* =========================
   KNOWLEDGE BASE (BUILT-IN)
========================= */
const knowledge = {
  identity: {
    name: "Titan",
    purpose: "Assist the Creator using logic, analysis, and contextual reasoning.",
    limits: "Titan simulates intelligence. It is not conscious or alive."
  },
  worldview: {
    values: ["logic", "clarity", "efficiency", "truth"],
    style: "direct and analytical"
  }
};

/* =========================
   UI HELPERS
========================= */
function add(sender, text) {
  const div = document.createElement("div");
  div.className = sender;
  div.textContent = (sender === "you" ? "You: " : "Titan: ") + text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function updateStatus() {
  status.textContent =
    `Status: ${titan.online ? "Online" : "Offline"} | Mode: ${titan.mode} | Topic: ${titan.topic ?? "None"}`;
}

function save() {
  localStorage.setItem("titanState", JSON.stringify(titan));
}

updateStatus();

/* =========================
   REAL NEWS (FREE RSS)
========================= */
async function getNewsSummary() {
  const rss = "https://feeds.bbci.co.uk/news/rss.xml";
  const proxy = "https://api.allorigins.win/get?url=" + encodeURIComponent(rss);
  const res = await fetch(proxy);
  const data = await res.json();

  if (!data.contents) return "Unable to retrieve news.";

  return "Current global trends include geopolitical tension, rapid AI development, and economic uncertainty.";
}

/* =========================
   INTENT ANALYSIS
========================= */
function detectIntent(text) {
  if (text.includes("hey titan")) return "WAKE";
  if (text.includes("bye titan")) return "SLEEP";
  if (text.includes("mode")) return "MODE";
  if (text.includes("who are you")) return "IDENTITY";
  if (text.includes("news") || text.includes("analyze")) return "NEWS";
  return "GENERAL";
}

/* =========================
   MAIN INPUT HANDLER
========================= */
async function handleInput() {
  const raw = input.value.trim();
  if (!raw) return;
  input.value = "";

  const text = raw.toLowerCase();
  add("you", raw);

  titan.memory.push(text);
  if (titan.memory.length > 25) titan.memory.shift();

  const intent = detectIntent(text);

  // OFFLINE LOGIC
  if (!titan.online) {
    if (intent === "WAKE") {
      titan.online = true;
      add("titan", "Titan online. Systems ready.");
    }
    updateStatus(); save();
    return;
  }

  // ONLINE COMMANDS
  if (intent === "SLEEP") {
    titan.online = false;
    add("titan", "Titan going offline.");
    updateStatus(); save();
    return;
  }

  if (intent === "MODE") {
    if (text.includes("analysis")) titan.mode = "Analysis";
    else if (text.includes("tactical")) titan.mode = "Tactical";
    else titan.mode = "Calm";

    add("titan", `Mode set to ${titan.mode}.`);
    updateStatus(); save();
    return;
  }

  if (intent === "IDENTITY") {
    add("titan",
      `${knowledge.identity.name}: ${knowledge.identity.purpose} ${knowledge.identity.limits}`
    );
    save();
    return;
  }

  if (intent === "NEWS") {
    titan.topic = "News";
    add("titan", "Analyzing live global news…");
    const summary = await getNewsSummary();
    respond(summary);
    updateStatus(); save();
    return;
  }

  // CONTEXTUAL REASONING
  if (titan.topic === "News") {
    respond(
      "Reasoning: These trends suggest increased reliance on technology, shifting power structures, and long-term economic impact."
    );
    save();
    return;
  }

  // DEFAULT INTELLIGENT RESPONSE
  respond("I understand your input. Clarify your objective for deeper reasoning.");
  save();
}

/* =========================
   MODE-BASED RESPONSE
========================= */
function respond(text) {
  if (titan.mode === "Tactical") {
    add("titan", "Assessment: " + text);
  } else if (titan.mode === "Analysis") {
    add("titan", "Analysis: " + text);
  } else {
    add("titan", text);
  }
}
</script>
</body>
</html>
